{
  "version": 3,
  "sources": ["../../three/examples/jsm/controls/DragControls.js"],
  "sourcesContent": ["import {\n\tEventDispatcher,\n\tMatrix4,\n\tPlane,\n\tRaycaster,\n\tVector2,\n\tVector3\n} from 'three';\n\nconst _plane = new Plane();\nconst _raycaster = new Raycaster();\n\nconst _pointer = new Vector2();\nconst _offset = new Vector3();\nconst _diff = new Vector2();\nconst _previousPointer = new Vector2();\nconst _intersection = new Vector3();\nconst _worldPosition = new Vector3();\nconst _inverseMatrix = new Matrix4();\n\nconst _up = new Vector3();\nconst _right = new Vector3();\n\nclass DragControls extends EventDispatcher {\n\n\tconstructor( _objects, _camera, _domElement ) {\n\n\t\tsuper();\n\n\t\t_domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t\tlet _selected = null, _hovered = null;\n\n\t\tconst _intersections = [];\n\n\t\tthis.mode = 'translate';\n\n\t\tthis.rotateSpeed = 1;\n\n\t\t//\n\n\t\tconst scope = this;\n\n\t\tfunction activate() {\n\n\t\t\t_domElement.addEventListener( 'pointermove', onPointerMove );\n\t\t\t_domElement.addEventListener( 'pointerdown', onPointerDown );\n\t\t\t_domElement.addEventListener( 'pointerup', onPointerCancel );\n\t\t\t_domElement.addEventListener( 'pointerleave', onPointerCancel );\n\n\t\t}\n\n\t\tfunction deactivate() {\n\n\t\t\t_domElement.removeEventListener( 'pointermove', onPointerMove );\n\t\t\t_domElement.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\t_domElement.removeEventListener( 'pointerup', onPointerCancel );\n\t\t\t_domElement.removeEventListener( 'pointerleave', onPointerCancel );\n\n\t\t\t_domElement.style.cursor = '';\n\n\t\t}\n\n\t\tfunction dispose() {\n\n\t\t\tdeactivate();\n\n\t\t}\n\n\t\tfunction getObjects() {\n\n\t\t\treturn _objects;\n\n\t\t}\n\n\t\tfunction setObjects( objects ) {\n\n\t\t\t_objects = objects;\n\n\t\t}\n\n\t\tfunction getRaycaster() {\n\n\t\t\treturn _raycaster;\n\n\t\t}\n\n\t\tfunction onPointerMove( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tupdatePointer( event );\n\n\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\n\t\t\tif ( _selected ) {\n\n\t\t\t\tif ( scope.mode === 'translate' ) {\n\n\t\t\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t\t\t_selected.position.copy( _intersection.sub( _offset ).applyMatrix4( _inverseMatrix ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( scope.mode === 'rotate' ) {\n\n\t\t\t\t\t_diff.subVectors( _pointer, _previousPointer ).multiplyScalar( scope.rotateSpeed );\n\t\t\t\t\t_selected.rotateOnWorldAxis( _up, _diff.x );\n\t\t\t\t\t_selected.rotateOnWorldAxis( _right.normalize(), - _diff.y );\n\n\t\t\t\t}\n\n\t\t\t\tscope.dispatchEvent( { type: 'drag', object: _selected } );\n\n\t\t\t\t_previousPointer.copy( _pointer );\n\n\t\t\t} else {\n\n\t\t\t\t// hover support\n\n\t\t\t\tif ( event.pointerType === 'mouse' || event.pointerType === 'pen' ) {\n\n\t\t\t\t\t_intersections.length = 0;\n\n\t\t\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\t\t\t\t\t_raycaster.intersectObjects( _objects, scope.recursive, _intersections );\n\n\t\t\t\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t\t\t\tconst object = _intersections[ 0 ].object;\n\n\t\t\t\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( object.matrixWorld ) );\n\n\t\t\t\t\t\tif ( _hovered !== object && _hovered !== null ) {\n\n\t\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t\t\t\t_hovered = null;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( _hovered !== object ) {\n\n\t\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveron', object: object } );\n\n\t\t\t\t\t\t\t_domElement.style.cursor = 'pointer';\n\t\t\t\t\t\t\t_hovered = object;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( _hovered !== null ) {\n\n\t\t\t\t\t\t\tscope.dispatchEvent( { type: 'hoveroff', object: _hovered } );\n\n\t\t\t\t\t\t\t_domElement.style.cursor = 'auto';\n\t\t\t\t\t\t\t_hovered = null;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_previousPointer.copy( _pointer );\n\n\t\t}\n\n\t\tfunction onPointerDown( event ) {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tupdatePointer( event );\n\n\t\t\t_intersections.length = 0;\n\n\t\t\t_raycaster.setFromCamera( _pointer, _camera );\n\t\t\t_raycaster.intersectObjects( _objects, scope.recursive, _intersections );\n\n\t\t\tif ( _intersections.length > 0 ) {\n\n\t\t\t\tif ( scope.transformGroup === true ) {\n\n\t\t\t\t\t// look for the outermost group in the object's upper hierarchy\n\n\t\t\t\t\t_selected = findGroup( _intersections[ 0 ].object );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_selected = _intersections[ 0 ].object;\n\n\t\t\t\t}\n\n\t\t\t\t_plane.setFromNormalAndCoplanarPoint( _camera.getWorldDirection( _plane.normal ), _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t\tif ( _raycaster.ray.intersectPlane( _plane, _intersection ) ) {\n\n\t\t\t\t\tif ( scope.mode === 'translate' ) {\n\n\t\t\t\t\t\t_inverseMatrix.copy( _selected.parent.matrixWorld ).invert();\n\t\t\t\t\t\t_offset.copy( _intersection ).sub( _worldPosition.setFromMatrixPosition( _selected.matrixWorld ) );\n\n\t\t\t\t\t} else if ( scope.mode === 'rotate' ) {\n\n\t\t\t\t\t\t// the controls only support Y+ up\n\t\t\t\t\t\t_up.set( 0, 1, 0 ).applyQuaternion( _camera.quaternion ).normalize();\n\t\t\t\t\t\t_right.set( 1, 0, 0 ).applyQuaternion( _camera.quaternion ).normalize();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t_domElement.style.cursor = 'move';\n\n\t\t\t\tscope.dispatchEvent( { type: 'dragstart', object: _selected } );\n\n\t\t\t}\n\n\t\t\t_previousPointer.copy( _pointer );\n\n\t\t}\n\n\t\tfunction onPointerCancel() {\n\n\t\t\tif ( scope.enabled === false ) return;\n\n\t\t\tif ( _selected ) {\n\n\t\t\t\tscope.dispatchEvent( { type: 'dragend', object: _selected } );\n\n\t\t\t\t_selected = null;\n\n\t\t\t}\n\n\t\t\t_domElement.style.cursor = _hovered ? 'pointer' : 'auto';\n\n\t\t}\n\n\t\tfunction updatePointer( event ) {\n\n\t\t\tconst rect = _domElement.getBoundingClientRect();\n\n\t\t\t_pointer.x = ( event.clientX - rect.left ) / rect.width * 2 - 1;\n\t\t\t_pointer.y = - ( event.clientY - rect.top ) / rect.height * 2 + 1;\n\n\t\t}\n\n\t\tfunction findGroup( obj, group = null ) {\n\n\t\t\tif ( obj.isGroup ) group = obj;\n\n\t\t\tif ( obj.parent === null ) return group;\n\n\t\t\treturn findGroup( obj.parent, group );\n\n\t\t}\n\n\t\tactivate();\n\n\t\t// API\n\n\t\tthis.enabled = true;\n\t\tthis.recursive = true;\n\t\tthis.transformGroup = false;\n\n\t\tthis.activate = activate;\n\t\tthis.deactivate = deactivate;\n\t\tthis.dispose = dispose;\n\t\tthis.getObjects = getObjects;\n\t\tthis.getRaycaster = getRaycaster;\n\t\tthis.setObjects = setObjects;\n\n\t}\n\n}\n\nexport { DragControls };\n"],
  "mappings": "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",
  "names": []
}
